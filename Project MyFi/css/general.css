/* App-wide: disable long-press callout & selection by default */
.app-no-context,
.app-no-context *:not([data-allow-context]) {
  -webkit-touch-callout: none;   /* iOS long-press menu */
  -webkit-user-select: none;
  user-select: none;
}

/* Opt-outs (allowed zones): forms, editors, and any element you mark */
.app-no-context input,
.app-no-context textarea,
.app-no-context select,
.app-no-context [contenteditable="true"],
.app-no-context .allow-select,
.app-no-context [data-allow-context] {
  -webkit-touch-callout: default;
  -webkit-user-select: text;
  user-select: text;
}

/* Music toggle button (inherits your existing .btn styles) */
.music-btn {
  display: inline-flex;
  align-items: center;
  gap: .5rem;
  pointer-events: auto; /* ensure clickable in glass headers */
}

.music-btn.is-muted .music-btn__icon {
  opacity: .6;
  filter: grayscale(0.3);
}

/* If you use icon-only at small widths, you can hide the label */
@media (max-width: 420px) {
  .music-btn .music-btn__label { display: none; }
}

/* =========================================================
   Edge Glow (navigation affordance + notifications)
   ========================================================= */
.edge-glow-mount {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 59; /* just under nav arrows (60) */
}

/* one layer that hosts 4 strips */
.edge-glow {
  position: fixed;
  inset: 0;
  pointer-events: none;
}

.edge-glow__strip {
  position: absolute;
  pointer-events: none;
  opacity: var(--eg-opacity, .8);              /* stronger base visibility */
  transition: opacity .18s ease, transform .18s ease;
  /* thickness & colour driven by CSS vars below */
}

/* -------- Default theme variables (override per-strip with tones) -------- */
.edge-glow__strip {
  --eg-thickness: 10px;                        /* was 6px */
  --eg-color: 160, 210, 255;                   /* cool cyan-white */
  --eg-alpha: 0.42;                            /* was 0.28 */
  --eg-blur: 16px;                             /* slightly stronger blur */
}

/* Top */
.edge-glow__strip[data-dir="up"] {
  left: 0; right: 0; top: 0; height: var(--eg-thickness);
  background: linear-gradient(to bottom, rgba(var(--eg-color), var(--eg-alpha)), rgba(var(--eg-color), 0));
  filter: blur(var(--eg-blur));
}
/* Right */
.edge-glow__strip[data-dir="right"] {
  top: 0; bottom: 0; right: 0; width: var(--eg-thickness);
  background: linear-gradient(to left, rgba(var(--eg-color), var(--eg-alpha)), rgba(var(--eg-color), 0));
  filter: blur(var(--eg-blur));
}
/* Bottom */
.edge-glow__strip[data-dir="down"] {
  left: 0; right: 0; bottom: 0; height: var(--eg-thickness);
  background: linear-gradient(to top, rgba(var(--eg-color), var(--eg-alpha)), rgba(var(--eg-color), 0));
  filter: blur(var(--eg-blur));
}
/* Left */
.edge-glow__strip[data-dir="left"] {
  top: 0; bottom: 0; left: 0; width: var(--eg-thickness);
  background: linear-gradient(to right, rgba(var(--eg-color), var(--eg-alpha)), rgba(var(--eg-color), 0));
  filter: blur(var(--eg-blur));
}

/* Hidden when navigation not available for that edge */
.edge-glow__strip.is-disabled { opacity: 0; }

/* Peek when user nears an edge or on arrow-key hint */
.edge-glow__strip.is-peek {
  --eg-thickness: 16px;
  --eg-alpha: 0.58;
  --eg-opacity: .95;
}

/* Drag progress (we push thickness more) */
.edge-glow__strip.is-drag {
  --eg-thickness: 22px;
  --eg-alpha: 0.62;
  --eg-opacity: 1;
}

/* Notification tones (can be set per-edge) */
.edge-glow__strip.tone-default { --eg-color: 160, 210, 255; --eg-alpha: .42; }
.edge-glow__strip.tone-notify  { --eg-color: 255, 200,  90; --eg-alpha: .50; }  /* gold */
.edge-glow__strip.tone-alert   { --eg-color: 255, 110, 110; --eg-alpha: .55; }  /* red */
.edge-glow__strip.tone-okay    { --eg-color:  80, 230, 170; --eg-alpha: .48; }  /* green */

/* Optional: light chevron etched into the glow (lets you drop arrow buttons) */
.edge-glow__strip::after {
  content: "";
  position: absolute;
  width: 0; height: 0;
  opacity: .95;
  filter: drop-shadow(0 1px 1px rgba(0,0,0,.25));
}
.edge-glow__strip[data-dir="left"]::after  {
  border-style: solid; border-width: 8px 12px 8px 0;
  border-color: transparent rgba(255,255,255,.95) transparent transparent;
  left: 6px; top: 50%; transform: translateY(-50%);
}
.edge-glow__strip[data-dir="right"]::after {
  border-style: solid; border-width: 8px 0 8px 12px;
  border-color: transparent transparent transparent rgba(255,255,255,.95);
  right: 6px; top: 50%; transform: translateY(-50%);
}
.edge-glow__strip[data-dir="up"]::after    {
  border-style: solid; border-width: 0 8px 12px 8px;
  border-color: transparent transparent rgba(255,255,255,.95) transparent;
  top: 6px; left: 50%; transform: translateX(-50%);
}
.edge-glow__strip[data-dir="down"]::after  {
  border-style: solid; border-width: 12px 8px 0 8px;
  border-color: rgba(255,255,255,.95) transparent transparent transparent;
  bottom: 6px; left: 50%; transform: translateX(-50%);
}

/* Subtle pulse for notifications */
@keyframes egPulse {
  0%   { --eg-thickness: 10px; --eg-alpha: .50; --eg-opacity: .8; }
  50%  { --eg-thickness: 18px; --eg-alpha: .75; --eg-opacity: 1; }
  100% { --eg-thickness: 10px; --eg-alpha: .50; --eg-opacity: .8; }
}
.edge-glow__strip.is-pulsing {
  animation: egPulse 1.4s ease-in-out infinite;
}

/* -------- Legend labels near edges (for tours / hints) -------- */
.edge-glow-legend {
  position: fixed;
  z-index: 61;
  color: #fff;
  font: 600 12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  background: rgba(30,35,60,.55);
  border: 1px solid rgba(220,230,255,.18);
  border-radius: 10px;
  padding: 6px 9px;
  backdrop-filter: blur(8px) saturate(120%);
  pointer-events: none;
  text-shadow: 0 1px 2px rgba(0,0,0,.35);
}

.edge-glow-legend[data-dir="left"]  { left: 10px;  top: 50%; transform: translateY(-50%); }
.edge-glow-legend[data-dir="right"] { right: 10px; top: 50%; transform: translateY(-50%); }
.edge-glow-legend[data-dir="up"]    { top: 10px;   left: 50%; transform: translateX(-50%); }
.edge-glow-legend[data-dir="down"]  { bottom: 10px;left: 50%; transform: translateX(-50%); }
