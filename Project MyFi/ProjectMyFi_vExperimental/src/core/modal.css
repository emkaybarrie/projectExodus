/* src/core/modal.css */
/* Root & layer */
#modal-root { position: fixed; inset: 0; z-index: 999; pointer-events: none; }
.modal-layer { position: absolute; inset: 0; pointer-events: none; }

/* Overlay */
.modal-overlay {
  position: absolute; inset: 0;
  background: rgba(4, 6, 12, .55);
  backdrop-filter: blur(4px);
  opacity: 0;
  transition: opacity 140ms ease;
  pointer-events: auto;
}

/* Card */
.modal-card {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -46%) scale(.98);

  width: min(720px, 96vw);
  max-width: 96vw;
  max-height: calc(100vh - 40px);

  display: flex;
  flex-direction: column;
  overflow: hidden;

  background: rgba(18,14,33,.96);
  border: 1px solid rgba(255,255,255,.08);
  border-radius: 16px;
  box-shadow: 0 18px 40px rgba(0,0,0,.45);

  transition: transform 160ms ease, opacity 160ms ease;
  opacity: 0;

  pointer-events: auto;
}

/* When open */
#modal-root.modal-open .modal-overlay { opacity: 1; }
#modal-root.modal-open .modal-card {
  transform: translate(-50%, -50%) scale(1);
  opacity: 1;
}

/* Close button */
.modal-close-btn {
  position:absolute; right:8px; top:8px;
  border:0; background:transparent; color:#ddd;
  font-size:20px; cursor:pointer;
}

/* Inner layout (Title → Header → Body → Footer) */
.modal-inner {
  display: flex; flex-direction: column;
  max-width: 100%; min-width: 0;
  color: #fff;
  padding: 16px;
  gap: 0;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
}

/* Title */
.modal-head-title {
  font-family: 'Cinzel', serif;
  font-size: 16px; font-weight: 500;
  letter-spacing: .06em; color: #fff; line-height: 1.3;
}

/* Header (sticky) */
.modal-head {
  position: sticky; top: 0; z-index: 3;
  background: inherit;
  padding-bottom: 8px;
  display: flex; flex-direction: column; row-gap: 6px;
}

/* Body (scrolls) */
.modal-body {
  flex: 1 1 auto;
  min-height: 0;
  overflow-y: auto;
  overflow-x: hidden;
  padding-top: 4px;
  padding-bottom: 8px;
  display: grid; row-gap: 12px;
  font-size: 14px; line-height: 1.4;
  -webkit-overflow-scrolling: touch;
}

/* Footer (sticky) */
.modal-footer {
  position: sticky; bottom: 0; z-index: 3;
  background: inherit;
  display: flex; flex-wrap: wrap;
  justify-content: flex-end;
  column-gap: 8px; row-gap: 8px;
  padding-top: 8px;
  border-top: 1px solid rgba(255,255,255,.08);
  font-size: 14px; line-height: 1.3;
}

/* Sections inside body */
.modal-section {
  display: block;
  max-width: 100%;
  min-width: 0;
  padding: 8px 0;
}

/* Direction helpers (applied by JS) */
.is-vertical {
  display: grid;
  overflow-y: auto; overflow-x: hidden;
}
.is-horizontal {
  display: grid;
  grid-auto-flow: column;
  grid-auto-columns: 100%;
  overflow-x: auto; overflow-y: hidden;
}

/* Snap helpers */
.scroll-snap-y { scroll-snap-type: y var(--snap-mode, mandatory); }
.scroll-snap-x { scroll-snap-type: x var(--snap-mode, mandatory); }
.modal-section { scroll-snap-align: start; }

/* Buttons */
.modal-btn {
  appearance: none;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,.2);
  background: rgba(255,255,255,.05);
  color: #fff;
  font-size: 14px; line-height: 1.2;
  padding: 8px 12px; cursor: pointer;
}
.modal-btn:active { background: rgba(255,255,255,.08); }
.modal-btn-primary {
  border: 1px solid rgba(120,140,255,.4);
  background: rgba(120,140,255,.15);
  box-shadow: 0 0 12px rgba(120,140,255,.4);
  font-weight: 600;
}
.modal-btn-danger {
  border: 1px solid rgba(255,80,80,.4);
  background: rgba(255,80,80,.15);
  box-shadow: 0 0 12px rgba(255,80,80,.4);
  font-weight: 600;
}

/* Form helpers (unchanged from your baseline) */
.form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
@media (max-width: 400px){ .form-row { grid-template-columns: 1fr; } }
.form-field { display: grid; row-gap: 4px; min-width: 0; }
.form-label { font-size: 12px; color: rgba(255,255,255,.8); line-height: 1.4; }
.form-hint  { font-size: 12px; color: rgba(255,255,255,.6); line-height: 1.4; }
.form-error { font-size: 12px; color: #ff6b6b; min-height: 16px; }
.form-input, .form-select {
  width: 100%; min-width: 0;
  font-size: 14px; line-height: 1.4; color: #fff;
  border-radius: 8px; border: 1px solid rgba(255,255,255,.15);
  background: rgba(0,0,0,.3); padding: 8px 10px;
}

/* PATCH - 09/11 */
/* --- Make the middle actually scroll on mobile and desktop --- */
.modal-body{
  flex: 1 1 auto;
  max-height: 50vh;
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;  /* momentum scroll on iOS */
  overscroll-behavior: contain;       /* stop body/page scroll chaining */
  scroll-behavior: smooth;            /* nice default for programmatic scrolls */
  padding-block: 12px;                /* breathing room so content doesn't kiss sticky bars */
}

/* --- Make header/footer opaque while sticky --- */
.modal-head,
.modal-footer{
  position: sticky;
  z-index: 2;                         /* sit above scrolled content */
  background: rgba(18,14,33,.96);     /* same card tone, slightly more opaque */
  backdrop-filter: saturate(120%) blur(3px);
}

/* pin positions for stickies */
.modal-head{ top: 0;  padding-bottom: 8px; }
.modal-footer{
  bottom: 0;
  padding-top: 8px;
  border-top: 1px solid rgba(255,255,255,.08);
}

/* subtle separators so content doesn’t feel underlapping */
.modal-head::after,
.modal-footer::before{
  content: "";
  position: absolute;
  left: 0; right: 0;
  height: 12px;
  pointer-events: none;
}
.modal-head::after{
  bottom: -12px;
  background: linear-gradient(to bottom, rgba(0,0,0,.18), rgba(0,0,0,0));
}
.modal-footer::before{
  top: -12px;
  background: linear-gradient(to top, rgba(0,0,0,.18), rgba(0,0,0,0));
}
