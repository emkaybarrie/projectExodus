# Forge Portal

Mobile-first control room for the Forge governance system.

## What It Is

The Forge Portal is a dynamic web dashboard designed for phone-first governance. It provides:

- **Live System Status**: Real-time Share Pack data with commit SHA and timestamps
- **Work Orders Management**: Browse, filter, and execute Work Orders from your phone
- **Create WO Wizard**: Generate prefilled GitHub Issues with clipboard fallback
- **Execute Affordance**: One-tap copy of `/execute` command + deep link to issues
- **Navigation**: Direct links to key documents and codebase locations

## How to Use

### Local Development

**Step 1: Generate JSON Indices**

Before the portal can display data, you need to generate the Share Pack indices:

```bash
# From repo root
node "The Forge/forge/ops/scripts/refresh-share-pack.mjs"
```

This creates:
- `The Forge/forge/exports/share-pack/share-pack.index.json`
- `The Forge/forge/exports/share-pack/work-orders.index.json`

**Step 2: Serve with a static server**

Due to CORS restrictions, you need a static server:

```bash
# Option A: VS Code Live Server (recommended)
# Right-click index.html → "Open with Live Server"

# Option B: Python
cd "c:/path/to/projectExodus"
python -m http.server 8080
# Then visit http://localhost:8080/The%20Forge/forge/portal/

# Option C: npx serve
npx serve .
```

**If indices are missing**: The portal shows a helpful error with exact instructions to generate them.

### Mobile Testing

1. Serve locally with a static server
2. Use browser DevTools device emulation
3. Or access via local network on your phone

### GitHub Pages Deployment

The portal is Pages-ready. After merge to main:

1. GitHub Actions deploys automatically (M2b workflow)
2. Portal will be available at `https://<user>.github.io/projectExodus/`

## File Structure

```
portal/
├── index.html    # Main portal page (shell)
├── app.js        # Application logic (data loading, screens, UX)
├── styles.css    # Mobile-first styles
└── README.md     # This file
```

## Features (M2c)

### Dashboard
- System status panel with live data from Share Pack
- Commit SHA and timestamp display
- Quick action buttons

### Work Orders Screen
- Filter chips: All / Draft / Pending / Approved / Executed
- Work Order cards with status badges
- View button (opens repo file)
- Execute button (for approved WOs)

### Create WO Wizard
- Form fields: Task ID, Type, Intent, Scope
- "Create Issue" opens prefilled GitHub Issue Form
- "Copy to Clipboard" fallback for mobile app weirdness
- Works even if URL prefill fails

### Execute Affordance
- Copies `/execute` to clipboard
- Opens filtered issues list (approved WOs)
- Toast notification confirms action

## Data Sources

Portal loads JSON indices from Share Pack:

| File | Contents |
|------|----------|
| `share-pack.index.json` | Timestamp, commit SHA, file hashes, headlines |
| `work-orders.index.json` | WO list with id, title, status, dates |

These are generated by `refresh-share-pack.mjs` on each push to main.

## Design Decisions

- **Mobile-first**: 320px base, scales up
- **Dark theme**: Matches MyFi cosmic aesthetic
- **Touch-friendly**: 44px minimum touch targets
- **No external dependencies**: Pure vanilla JS
- **No GitHub API auth**: Phase 1 reads static JSON only
- **Safe area support**: Works on notched phones
- **Reduced motion**: Respects user preferences

## Locked Decisions (M2c)

1. Share Pack truth is machine-readable JSON first, markdown second
2. Portal does not depend on GitHub API for Phase 1
3. Issue creation uses querystring prefill + clipboard fallback

## Related Work Orders

- **M2a**: Created initial portal and GitHub Issue Form
- **M2b**: Build automation and Pages deployment
- **M2c**: Live truth, Work Orders UX, Create/Execute flows
- **M2c1**: Fixed data source to use relative URLs, added graceful error handling
